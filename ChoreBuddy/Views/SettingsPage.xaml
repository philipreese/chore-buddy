<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:ChoreBuddy.ViewModels"
             xmlns:models="clr-namespace:ChoreBuddy.Models"
             xmlns:views="clr-namespace:ChoreBuddy.Views"
             x:Class="ChoreBuddy.Views.SettingsPage"
             x:DataType="vm:SettingsViewModel"
             Title="Settings"
             Style="{DynamicResource PageRoot}">

    <ScrollView>
        <VerticalStackLayout Spacing="10"
                             Padding="10">
            <Label Text="Preferences"
                   Style="{StaticResource HeaderText}"/>
            <Border Style="{StaticResource Card}">
                <views:ThemePickerView Padding="10" />
            </Border>
            <Border Style="{StaticResource Card}">
                <Grid ColumnDefinitions="*, Auto"
                      VerticalOptions="Start"
                      Padding="10">
                    <VerticalStackLayout Grid.Column="0">
                        <Label Text="Haptic Feedback" 
                               Style="{StaticResource HeaderText}" />
                        <HorizontalStackLayout Spacing="5">
                            <Label Text="&#xf05a;"
                                   FontFamily="FontAwesome"
                                   Style="{StaticResource BodyText}" />
                            <Label Text="Vibrate when completing chores" 
                                   Style="{StaticResource BodyText}" />
                        </HorizontalStackLayout>
                    </VerticalStackLayout>

                    <Switch Grid.Column="1" 
                            IsToggled="{Binding IsHapticFeedbackEnabled}" 
                            ThumbColor="{AppThemeBinding Light={DynamicResource TertiaryLight}, Dark={DynamicResource TertiaryDark}}"
                            OnColor="{AppThemeBinding Light={DynamicResource OnTertiaryContainerDark}, Dark={DynamicResource OnTertiaryContainerLight}}" />
                </Grid>
            </Border>
            <Border Style="{StaticResource Card}">
                <Grid ColumnDefinitions="*, Auto"
                      VerticalOptions="Start"
                      Padding="10">
                    <VerticalStackLayout Grid.Column="0">
                        <Label Text="Notifications" 
                               Style="{StaticResource HeaderText}" />
                        <Grid ColumnDefinitions="Auto, *"
                              ColumnSpacing="5">
                            <Label Text="&#xf05a;"
                                   FontFamily="FontAwesome"
                                   Style="{StaticResource BodyText}" />
                            <Label Grid.Column="1"
                                   Text="Allow Chore Buddy to send you notifications (necessary for due date alarms!)" 
                                   Style="{StaticResource BodyText}" />
                        </Grid>
                    </VerticalStackLayout>

                    <Switch Grid.Column="1" 
                            IsToggled="{Binding IsGlobalNotificationsEnabled}" 
                            ThumbColor="{AppThemeBinding Light={DynamicResource TertiaryLight}, Dark={DynamicResource TertiaryDark}}"
                            OnColor="{AppThemeBinding Light={DynamicResource OnTertiaryContainerDark}, Dark={DynamicResource OnTertiaryContainerLight}}" />
                </Grid>
            </Border>
            <Border Style="{StaticResource Card}">
                <Grid ColumnDefinitions="*, Auto"
                      VerticalOptions="Start"
                      Padding="10">
                    <VerticalStackLayout Grid.Column="0"
                                         VerticalOptions="Center">
                        <Label Text="Show Chore Details" 
                               Style="{StaticResource HeaderText}" />
                        <HorizontalStackLayout Spacing="5">
                            <Label Text="&#xf05a;"
                                   FontFamily="FontAwesome"
                                   Style="{StaticResource BodyText}" />
                            <Label Text="Display notes and history on cards" 
                                   Style="{StaticResource BodyText}" />
                        </HorizontalStackLayout>
                    </VerticalStackLayout>

                    <Switch Grid.Column="1" 
                            IsToggled="{Binding IsHistoryOnCardsVisible}" 
                            ThumbColor="{AppThemeBinding Light={DynamicResource TertiaryLight}, Dark={DynamicResource TertiaryDark}}"
                            OnColor="{AppThemeBinding Light={DynamicResource OnTertiaryContainerDark}, Dark={DynamicResource OnTertiaryContainerLight}}" />
                </Grid>
            </Border>

            <Label Text="Database Operations"
                   Style="{StaticResource HeaderText}"
                   Margin="0,10,0,0"/>
            <Border Grid.Row="1"
                    Padding="20"
                    Style="{StaticResource Card}">
                <VerticalStackLayout Grid.Column="0"
                                     VerticalOptions="Center">
                    <Label Text="Export/Import Data" 
                           Style="{StaticResource HeaderText}" />
                    <Grid ColumnDefinitions="Auto, *"
                              ColumnSpacing="5">
                        <Label Text="&#xf05a;"
                               FontFamily="FontAwesome"
                               Style="{StaticResource BodyText}" />
                        <Label Grid.Column="1"
                               Text="Save your current chores to a file or restore from a previous backup" 
                               Style="{StaticResource BodyText}" />
                    </Grid>
                    <Grid ColumnDefinitions="*,*"
                          Margin="0,10,0,0">
                        <Button Text="Export"
                                Margin="8,8,8,0"
                                Command="{Binding ExportDatabaseCommand}"
                                Style="{StaticResource TertiaryAltButton}">
                            <Button.ImageSource>
                                <FontImageSource Glyph="&#xf093;"
                                                 FontFamily="FontAwesome"
                                                 Size="16"
                                                 Color="{AppThemeBinding Light={DynamicResource TertiaryContainerDark}, Dark={DynamicResource TertiaryContainerLight}}"/>
                            </Button.ImageSource>
                        </Button>

                        <Button Text="Import"
                                Grid.Column="1"
                                Margin="8,8,8,0"                            
                                Command="{Binding ImportDatabaseCommand}"
                                Style="{StaticResource TertiaryButton}">
                            <Button.ImageSource>
                                <FontImageSource Glyph="&#xf019;"
                                                 FontFamily="FontAwesome"
                                                 Size="16"
                                                 Color="{AppThemeBinding Light={DynamicResource OnTertiaryLight}, Dark={DynamicResource OnTertiaryDark}}"/>
                            </Button.ImageSource>
                        </Button>
                    </Grid>

                    <ActivityIndicator IsRunning="{Binding IsBusy}" 
                                       IsVisible="{Binding IsBusy}"/>
                </VerticalStackLayout>
            </Border>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>